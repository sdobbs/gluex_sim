#include<cmath>
#include<TSpline.h>
static double zspline[] ={
0.05, 0.15, 0.25, 0.35, 0.45, 0.55, 0.65, 0.75, 
0.85, 0.95, 1.05, 1.15, 1.25, 1.35, 1.45, 1.55, 
1.65, 1.75, 1.85, 1.95, 2.05, 2.15, 2.25, 2.35, 
2.45, 2.55, 2.65, 2.75, 2.85, 2.95, 3.05, 3.15, 
3.25, 3.35, 3.45, 3.55, 3.65, 3.75, 3.85, 3.95, 
4.05, 4.15, 4.25, 4.35, 4.45, 4.55, 4.65, 4.75, 
4.85, 4.95, 5.05, 5.15, 5.25, 5.35, 5.45, 5.55, 
5.65, 5.75, 5.85, 5.95, 6.05, 6.15, 6.25, 6.35, 
6.45, 6.55, 6.65, 6.75, 6.85, 6.95, 7.05, 7.15, 
7.25, 7.35, 7.45, 7.55, 7.65, 7.75, 7.85, 7.95, 
8.05, 8.15, 8.25, 8.35, 8.45, 8.55, 8.65, 8.75, 
8.85, 8.95, 9.05, 9.15, 9.25, 9.35, 9.45, 9.55, 
9.65, 9.75, 9.85, 9.95, 0};
static double yspline[] ={
2.4679, 1.46446, 1.04428, 0.794215, 0.625331, 0.503364, 0.411517, 0.340341, 
0.284019, 0.238738, 0.201873, 0.171555, 0.146413, 0.125417, 0.107777, 0.0928821, 
0.0802476, 0.0694887, 0.060295, 0.0524144, 0.0456406, 0.0398035, 0.0347621, 0.0303989, 
0.0266156, 0.0233293, 0.0204701, 0.0179789, 0.0158054, 0.0139065, 0.0122456, 0.0107913, 
0.00951651, 0.008398, 0.00741571, 0.00655231, 0.00579278, 0.0051241, 0.00453499, 0.00401561, 
0.00355741, 0.00315293, 0.00279565, 0.0024799, 0.00220069, 0.00195366, 0.001735, 0.00154136, 
0.0013698, 0.00121774, 0.0010829, 0.000963279, 0.000857127, 0.000762889, 0.000679199, 0.000604849, 
0.000538777, 0.000480041, 0.000427812, 0.000381353, 0.000340017, 0.000303227, 0.000270476, 0.000241312, 
0.000215335, 0.000192192, 0.000171569, 0.000153187, 0.000136799, 0.000122185, 0.000109151, 9.75232e-05, 
8.71483e-05, 7.78893e-05, 6.96246e-05, 6.22462e-05, 5.56577e-05, 4.97737e-05, 4.45178e-05, 3.98224e-05, 
3.56268e-05, 3.18775e-05, 2.85262e-05, 2.55305e-05, 2.28521e-05, 2.04571e-05, 1.83152e-05, 1.63994e-05, 
1.46856e-05, 1.31524e-05, 1.17804e-05, 1.05527e-05, 9.45388e-06, 8.47032e-06, 7.58982e-06, 6.8015e-06, 
6.09563e-06, 5.46352e-06, 4.8974e-06, 4.39033e-06, 0};
double expint_map(double z){
  static TSpline3 *sp = NULL;
  if(!sp) sp = new TSpline3("sp", zspline, yspline, 100);
  if(z<10) return sp->Eval(z);
  return std::exp( (-2.17624) + (-1.02753)*z );
}
